<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link href="https://fonts.cdnfonts.com/css/aileron" rel="stylesheet">
    <link rel="stylesheet" href="./FeedbackStyle.css">
    <link rel="stylesheet" href="../style.css">

    <title>StarBinder Feedback Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <a href="../index.html" class="feedback-link">[ BACK TO STAR BINDER ]</a>
    <div class="container">
        <h1>Send Feedback</h1>

        <div class="paragraphText">
            <p>If you're having trouble with compatibility or bugs, make sure you try Star Binder in Chrome or Edge
                first - Firefox has issues that I can't resolve although I am building and testing in Firefox to make it
                work where I can.</p>
            <p>Not knowing or not understanding how to do something is ABSOLUTELY valid feedback. Star Binder is meant
                to be easy and intuitive, if it's not then it needs improving.</p>
        </div>
        <hr>

        <form id="feedbackForm" onsubmit="sendFeedback(event)">
            <label for="generalFeedback">General Feedback:</label>
            <textarea id="generalFeedback" name="generalFeedback" rows="4"
                placeholder="If you'd like a reply (no promises), be sure to include an email or some means of contact, e.g. your SC username on Spectrum."
                required></textarea>

            <button type="submit">Send Feedback</button>
        </form>

        <div id="status" class="status"></div>
    </div>

    <!-- EmailJS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script>
        (function ()
        {
            emailjs.init("Hcw7d4_S1ewp5gj-K");
        })();

        async function sendFeedback(event)
        {
            event.preventDefault();
            const status = document.getElementById("status");
            status.textContent = "Sending...";
            status.className = "status";

            const generalFeedback = document.getElementById("generalFeedback").value.trim();
            const missingBinds = document.getElementById("missingBinds").value.trim();

            const message = `
=== General Feedback ===
${ generalFeedback || "(none)" }

=== Missing Keybinds: ===
${ missingBinds || "(none)" }
      `.trim();

            try
            {
                await emailjs.send("service_b55xnpb", "template_sh2bm8a", {
                    message,
                    general_feedback: generalFeedback,
                    missing_binds: missingBinds
                });
                status.textContent = "✅ Feedback sent successfully — thank you!";
                status.classList.add("success");
                document.getElementById("feedbackForm").reset();
            } catch (err)
            {
                console.error(err);
                status.textContent = "❌ Failed to send feedback. Please try again later.";
                status.classList.add("error");
            }
        }
    </script>
    <a href="../index.html" class="feedback-link">[ BACK TO STAR BINDER ]</a>
</body>

</html>